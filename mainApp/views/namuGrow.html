<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ³TWOGETHER</title>
    <link rel="stylesheet" href="/stylesheets/namuGrow.css">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic+Coding&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" rel="stylesheet">
</head>

<body style="font-size: 22px;">

    <header>
        <div>
            <img src="images/twogether-logo.png" onclick="move()" alt="ë¡œê³ " width="380px" height="140px">
        </div>
    </header>

    <nav>
        <ul class="menubar">
            <span class="menu1"> <a href="/">í™ˆ</a></span>
            <span class="menu2"> <a href="/map">ì§€ì—­ ì„ íƒ</a></span>
            <span class="menu3"> <a href="/scH">ê´€ê´‘ ì•ˆë‚´ì†Œ</a></span>
            <span class="menu4"> <a href="/namuGrow">ë‚˜ë¬´ í‚¤ìš°ê¸°</a></span>
        </ul>
    </nav>

    <div class="box1">
        <div id="box2" class="box">
            <b class="title">ğŸŒ³ ì¹œí™˜ê²½ì ì¸ í–‰ë™ ì‹¤ì²œ ì‚¬í•­ ğŸŒ³</b>
            <div class="textBox">
                <div class='large-font text-center top-20'>
                    <ion-icon name="heart" class="heart">
                        <div class='red-bg'></div>
                    </ion-icon>
                    <span class="todo" data-key="ì“°ë ˆê¸° ì¤ê¸°">ì“°ë ˆê¸° ì¤ê¸°</span>
                </div>
                <div class='large-font text-center top-20'>
                    <ion-icon name="heart" class="heart">
                        <div class='red-bg'></div>
                    </ion-icon>
                    <span class="todo" data-key="í…€ë¸”ëŸ¬ ì‚¬ìš©í•˜ê¸°">í…€ë¸”ëŸ¬ ì‚¬ìš©í•˜ê¸°</span>
                </div>
                <div class='large-font text-center top-20'>
                    <ion-icon name="heart" class="heart">
                        <div class='red-bg'></div>
                    </ion-icon>
                    <span class="todo" data-key="í¬ì¥ìš©ê¸° ì§ì ‘ ê°€ì ¸ì˜¤ê¸°">í¬ì¥ìš©ê¸° ì§ì ‘ ê°€ì ¸ì˜¤ê¸°</span>
                </div>
                <div class='large-font text-center top-20'>
                    <ion-icon name="heart" class="heart">
                        <div class='red-bg'></div>
                    </ion-icon>
                    <span class="todo" data-key="ëŒ€ì¤‘êµí†µ ì´ìš©í•˜ê¸°">ëŒ€ì¤‘êµí†µ ì´ìš©í•˜ê¸°</span>
                </div>
                <div class='large-font text-center top-20'>
                    <ion-icon name="heart" class="heart">
                        <div class='red-bg'></div>
                    </ion-icon>
                    <span class="todo" data-key="ì¹œí™˜ê²½ ê´€ê´‘ì§€ ë°©ë¬¸í•˜ê¸°">ì¹œí™˜ê²½ ê´€ê´‘ì§€ ë°©ë¬¸í•˜ê¸°</span>
                </div>
                <div class='large-font text-center top-20'>
                    <ion-icon name="heart" class="heart">
                        <div class='red-bg'></div>
                    </ion-icon>
                    <span class="todo" data-key="ë´‰ì§€ ëŒ€ì‹  ì—ì½”ë°± ì‚¬ìš©í•˜ê¸°">ë´‰ì§€ ëŒ€ì‹  ì—ì½”ë°± ì‚¬ìš©í•˜ê¸°</span>
                </div>
                <div class='large-font text-center top-20'>
                    <ion-icon name="heart" class="heart">
                        <div class='red-bg'></div>
                    </ion-icon>
                    <span class="todo" data-key="ë…¹ìƒ‰ë§¤ì¥ ì´ìš©í•˜ê¸°">ë…¹ìƒ‰ë§¤ì¥ ì´ìš©í•˜ê¸°</span>
                </div>
                <ul class="items">
                    <div class="item--add--icon">
                        <i class="fas fa-plus-circle before"></i>
                    </div>
                </ul>
            </div>
        </div>

        <div id="box3" class="box">
            <div class="tree">
                <img id="tree" src="/images/sprout.png" style="width:400px; height:400px; text-align:center; align-items: center; ">
                <i class="fas fa-solid fa-leaf" id="leaf-icon" style="display: none;"></i>
                <i class="fab fa-brands fa-pagelines" id="pagelines-icon" style="display: none;"></i>
                <i class="fas fa-solid fa-tree" id="tree-icon" style="display: none;"></i>
            </div>
            <div class="nam">
                <p class="n">ë‚˜ë¬´ í‚¤ìš°ê¸° ì‚¬ìš© ì„¤ëª…ì„œ</p>
                <div class="gtop">
                    <p class="g">
                        1. ì‹¤ì²œ ì‚¬í•­ì€ ë§¤ì¼ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.<br> <br>2. ë‚˜ë¬´ëŠ” ì‹¤ì²œí•˜ëŠ” í–‰ë™ë“¤ì´ ë§ì•„ì§ˆìˆ˜ë¡ ì„±ì¥í•©ë‹ˆë‹¤.<br><br> 3. ë‚˜ë¬´ì˜ ì„±ì¥ ë‹¨ê³„ëŠ” ì´ 3ë‹¨ê³„ì…ë‹ˆë‹¤.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script>
        //í•˜íŠ¸ ì•„ì´ì½˜ js
        const todoSpans = document.querySelectorAll('.todo');

        // ê°ê°ì˜ span ìš”ì†Œì˜ ë‚´ìš©ì„ í‚¤ë¡œ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ localStorageì— ì €ì¥í•©ë‹ˆë‹¤.
        /*todoSpans.forEach(function(span) {
            const key = span.textContent.trim();
            const value = ''; // ì €ì¥í•  ê°’ì„ ê°€ì ¸ì˜¤ê±°ë‚˜ ìƒì„±í•©ë‹ˆë‹¤.
            localStorage.setItem(key, value);
        });*/

        const icons = document.querySelectorAll('ion-icon');
        icons.forEach(icon => {
            const todoElement = icon.nextElementSibling;

            // .todo ì—˜ë¦¬ë¨¼íŠ¸ì˜ ë‚´ìš©ì„ ê°€ì ¸ì™€ì„œ í‚¤ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
            const key = todoElement.getAttribute('data-key');

            // localStorageì—ì„œ í•´ë‹¹ í‚¤ì˜ ê°’ ê°€ì ¸ì˜¤ê¸°
            const value = localStorage.getItem(key);

            if (value == 'click') {
                // ê°’ì´ "click"ì¸ ê²½ìš° .heart ì•„ì´ì½˜ì— "active" í´ë˜ìŠ¤ ì¶”ê°€
                icon.classList.add('active');
            }
        });
        icons.forEach(icon => {
            icon.addEventListener('click', () => {
                const todoElement = icon.nextElementSibling;
                const keyToChange = todoElement.textContent.trim();
                const currentValue = localStorage.getItem(keyToChange);
                // ë³€ê²½í•˜ë ¤ëŠ” í‚¤
                const newValue = currentValue === 'click' ? 'unclick' : 'click'; // ìƒˆë¡œìš´ ê°’
                const oldValue = localStorage.getItem(keyToChange);
                localStorage.setItem(keyToChange, newValue);
                // ë³€ê²½ëœ ê°’ì„ í™”ë©´ì— í‘œì‹œí•˜ê±°ë‚˜ ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                if (newValue == 'click') {
                    icon.classList.add('active');
                } else {
                    icon.classList.remove('active');
                }
            });

        });


        //ë¦¬ìŠ¤íŠ¸ ì¶”ê°€ì‚­ì œ js
        const items = document.querySelector('.items');
        const itemPlus = document.querySelector('.item--add--icon');
        itemPlus.addEventListener('click', e => {
            const icons = document.querySelectorAll('ion-icon');
            icons.forEach(icon => {
                icon.addEventListener('click', () => {
                    icon.classList.toggle('active');
                });
            });
            let thisElement = e.target;
            if (thisElement.nodeName !== 'I') {
                thisElement = e.target.firstElementChild;
            }
            if (thisElement.classList.contains('fa-plus-circle')) {
                const itemElement = document.createElement('li');
                itemElement.classList.add('item');
                //ì²´í¬ë¥¼ í•˜íŠ¸ë¡œ ë°”ê¿ˆ
                const checkTag = document.createElement('div');
                checkTag.classList.add('item--heart');
                checkTag.innerHTML = `<ion-icon name="heart"class="heart"></ion-icon>`;
                //ë¦¬ìŠ¤íŠ¸ ì‘ì„±
                const textTag = document.createElement('input');
                textTag.setAttribute('type', 'text');
                textTag.classList.add('item--title');
                //ë¦¬ìŠ¤íŠ¸ ì‚­ì œ ì•„ì´ì½˜
                const spanTag = document.createElement('span');
                spanTag.classList.add('item--delete');
                spanTag.innerHTML = `<i class="fas fa-trash-alt"></i>`;

                itemElement.append(checkTag, textTag, spanTag);
                items.append(itemElement);
                thisElement.classList.remove('fa-plus-circle');
                thisElement.classList.add('fa-check');

                textTag.focus();
            } else if (thisElement.classList.contains('fa-check')) {
                const itemTitles = document.querySelectorAll('.item--title');
                const itemTitle = itemTitles[itemTitles.length - 1];
                if (itemTitle.value === null || itemTitle.value === '') {
                    const items = document.querySelectorAll('.item');
                    items[items.length - 1].remove();
                }
                itemTitle.setAttribute('disabled', true);
                itemTitle.style.border = 'none';
                itemTitle.style.backgroundColor = 'transparent';
                thisElement.classList.remove('fa-check');
                thisElement.classList.add('fa-plus-circle');
            }
        });
        const deleteBtns = document.querySelectorAll('.fa-trash-alt');
        items.addEventListener('click', e => {
            if (e.target.classList.contains('fa-trash-alt')) {
                if (e.target.classList.contains('fa-trash-alt')) {
                    const itemToDelete = e.target.closest('.item');
                    if (itemToDelete) {
                        itemToDelete.remove();
                    }
                }
            }
        });

        window.addEventListener('keydown', e => {
            if (e.keyCode !== 13) {
                e.stopPropagation();
                return;
            }
            itemPlus.click();
        });




        function updateIcon(heartCount) {
            if (heartCount >= 5) {
                document.getElementById("tree").src = "/images/forest.png";
            } else if (heartCount >= 3) {
                document.getElementById("tree").src = "/images/tree.png";
            } else if (heartCount >= 1) {
                document.getElementById("tree").src = "/images/leaves.png";
            } else {
                document.getElementById("tree").src = "/images/sprout.png";
            }

        }
        let heartCount = 0;
        const heart = document.querySelectorAll('ion-icon');
        heart.forEach(icon => {
            icon.addEventListener('click', () => {
                if (icon.classList.contains('active')) {
                    heartCount = heartCount + 1;
                    updateIcon(heartCount);
                    console.log(heartCount);
                } else {
                    heartCount = heartCount - 1;
                    updateIcon(heartCount);
                    console.log(heartCount);
                }
            });


        });

        function move() {
            location.href = "/";
        }
        // í´ë¦­í•  ë•Œë§ˆë‹¤ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
    </script>

    <script src="/javascripts/storage.js" type="text/javascript"></script>
</body>

</html>